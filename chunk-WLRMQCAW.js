import{d as Te,e as ye,f as De,g as Ee}from"./chunk-GUQKOEOD.js";import{a as Se,b as Ce}from"./chunk-54OSNODU.js";import{$ as w,Aa as re,Bb as qe,Ea as oe,F as p,Fa as ae,G as h,Ga as se,Ha as pe,Ia as me,Ja as O,K as u,Ka as C,L as W,M as c,Ma as H,N as n,O as l,P as d,Q as X,R as Z,S as V,T as E,U as g,V as f,aa as ee,ab as T,b as G,ba as s,bb as ue,ca as v,da as R,eb as ce,f as L,g as J,h as $,ha as A,ia as q,ja as M,jb as de,k as S,kb as k,l as Y,mb as ge,nb as fe,p as D,pa as te,pb as _e,qb as he,r as x,ra as F,rb as ve,s as b,sa as I,vb as xe,wa as ie,xb as be,y as K,ya as ne,yb as y,za as le}from"./chunk-2TYDJMCA.js";import"./chunk-2XJVAMHT.js";var P=["STAND_BY","VERIFIED","APPROVE","REJECT","SENT","CANCELLED"];function Ae(t,r){t&1&&V(0)}function Me(t,r){t&1&&V(0)}var j=function(t){return{$implicit:t}};function Oe(t,r){if(t&1&&(X(0),u(1,Me,1,0,"ng-container",4),Z()),t&2){let a=f().$implicit,e=f();p(1),c("ngTemplateOutlet",e.markerTemplate)("ngTemplateOutletContext",M(2,j,a))}}function He(t,r){t&1&&d(0,"div",10)}function Ne(t,r){t&1&&d(0,"div",11)}function $e(t,r){t&1&&V(0)}function Pe(t,r){if(t&1&&(n(0,"div",2)(1,"div",3),u(2,Ae,1,0,"ng-container",4),l(),n(3,"div",5),u(4,Oe,2,4,"ng-container",6),u(5,He,1,0,"ng-template",null,7,re),u(7,Ne,1,0,"div",8),l(),n(8,"div",9),u(9,$e,1,0,"ng-container",4),l()()),t&2){let a=r.$implicit,e=r.last,i=W(6),o=f();p(2),c("ngTemplateOutlet",o.oppositeTemplate)("ngTemplateOutletContext",M(7,j,a)),p(2),c("ngIf",o.markerTemplate)("ngIfElse",i),p(3),c("ngIf",!e),p(2),c("ngTemplateOutlet",o.contentTemplate)("ngTemplateOutletContext",M(9,j,a))}}var je=function(t,r,a,e,i,o,m){return{"p-timeline p-component":!0,"p-timeline-left":t,"p-timeline-right":r,"p-timeline-top":a,"p-timeline-bottom":e,"p-timeline-alternate":i,"p-timeline-vertical":o,"p-timeline-horizontal":m}},Re=(()=>{class t{el;value;style;styleClass;align="left";layout="vertical";templates;contentTemplate;oppositeTemplate;markerTemplate;constructor(a){this.el=a}getBlockableElement(){return this.el.nativeElement.children[0]}ngAfterContentInit(){this.templates.forEach(a=>{switch(a.getType()){case"content":this.contentTemplate=a.template;break;case"opposite":this.oppositeTemplate=a.template;break;case"marker":this.markerTemplate=a.template;break}})}static \u0275fac=function(e){return new(e||t)(h(K))};static \u0275cmp=S({type:t,selectors:[["p-timeline"]],contentQueries:function(e,i,o){if(e&1&&ne(o,T,4),e&2){let m;ie(m=le())&&(i.templates=m)}},hostAttrs:[1,"p-element"],inputs:{value:"value",style:"style",styleClass:"styleClass",align:"align",layout:"layout"},decls:2,vars:13,consts:[[3,"ngStyle","ngClass"],["class","p-timeline-event",4,"ngFor","ngForOf"],[1,"p-timeline-event"],[1,"p-timeline-event-opposite"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-timeline-event-separator"],[4,"ngIf","ngIfElse"],["marker",""],["class","p-timeline-event-connector",4,"ngIf"],[1,"p-timeline-event-content"],[1,"p-timeline-event-marker"],[1,"p-timeline-event-connector"]],template:function(e,i){e&1&&(n(0,"div",0),u(1,Pe,10,11,"div",1),l()),e&2&&(ee(i.styleClass),c("ngStyle",i.style)("ngClass",te(5,je,i.align==="left",i.align==="right",i.align==="top",i.align==="bottom",i.align==="alternate",i.layout==="vertical",i.layout==="horizontal")),p(1),c("ngForOf",i.value))},dependencies:[oe,ae,se,me,pe],styles:[`@layer primeng{.p-timeline{display:flex;flex-grow:1;flex-direction:column}.p-timeline-left .p-timeline-event-opposite{text-align:right}.p-timeline-left .p-timeline-event-content{text-align:left}.p-timeline-right .p-timeline-event{flex-direction:row-reverse}.p-timeline-right .p-timeline-event-opposite{text-align:left}.p-timeline-right .p-timeline-event-content{text-align:right}.p-timeline-vertical.p-timeline-alternate .p-timeline-event:nth-child(even){flex-direction:row-reverse}.p-timeline-vertical.p-timeline-alternate .p-timeline-event:nth-child(odd) .p-timeline-event-opposite{text-align:right}.p-timeline-vertical.p-timeline-alternate .p-timeline-event:nth-child(odd) .p-timeline-event-content{text-align:left}.p-timeline-vertical.p-timeline-alternate .p-timeline-event:nth-child(even) .p-timeline-event-opposite{text-align:left}.p-timeline-vertical.p-timeline-alternate .p-timeline-event:nth-child(even) .p-timeline-event-content{text-align:right}.p-timeline-event{display:flex;position:relative;min-height:70px}.p-timeline-event:last-child{min-height:0}.p-timeline-event-opposite,.p-timeline-event-content{flex:1;padding:0 1rem}.p-timeline-event-separator{flex:0;display:flex;align-items:center;flex-direction:column}.p-timeline-event-marker{display:flex;align-self:baseline}.p-timeline-event-connector{flex-grow:1}.p-timeline-horizontal{flex-direction:row}.p-timeline-horizontal .p-timeline-event{flex-direction:column;flex:1}.p-timeline-horizontal .p-timeline-event:last-child{flex:0}.p-timeline-horizontal .p-timeline-event-separator{flex-direction:row}.p-timeline-horizontal .p-timeline-event-connector{width:100%}.p-timeline-bottom .p-timeline-event{flex-direction:column-reverse}.p-timeline-horizontal.p-timeline-alternate .p-timeline-event:nth-child(even){flex-direction:column-reverse}}
`],encapsulation:2,changeDetection:0})}return t})(),Fe=(()=>{class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=Y({type:t});static \u0275inj=J({imports:[C,ue]})}return t})();var N=(()=>{let r=class r{constructor(e,i){this.http=e,this.currentUser=i,this._requestSelected=new G(null)}get requestSelected(){return this._requestSelected.asObservable()}get requestSelectedValue(){return this._requestSelected.value}set requestSelected(e){this._requestSelected.next(e)}getlookRequestDetails(){return this.http.get(`${y.url}requests?requestId=${this._requestSelected.value?.id}`)}getRequests(){return this.http.get(`${y.url}requests/user?userId=${this.currentUser.currentUserValue.id}`)}deleteRequest(){return this.http.delete(`${y.url}requests/delete?requestId=${this._requestSelected.value?.id}`)}sendRequest(){return this.http.post(`${y.url}requests/send?requestId=${this._requestSelected.value?.id}`,{})}createRequest(e){return this.http.post(`${y.url}requests/create?userId=`+this.currentUser.currentUserValue.id,e)}};r.\u0275fac=function(i){return new(i||r)($(H),$(qe))},r.\u0275prov=L({token:r,factory:r.\u0275fac,providedIn:"root"});let t=r;return t})();function Qe(t,r){t&1&&d(0,"span",14)}function Ge(t,r){if(t&1&&(n(0,"small",15),s(1),F(2,"date"),l()),t&2){let a=r.$implicit;p(1),v(I(2,1,a.changeDate))}}function Le(t,r){if(t&1&&s(0),t&2){let a=r.$implicit,e=f();R(" ",e.getStatusHistory(a)," ")}}var ke=(()=>{let r=class r{constructor(e,i){this.requestService=e,this.http=i,this.selectedRequest=D(null)}ngOnInit(){this.requestService.getlookRequestDetails().subscribe({next:e=>{this.selectedRequest.set(e)}})}get status(){return P[this.selectedRequest()?.statusId-1||0]}getStatusHistory(e){return P[e.statusId-1||0]}};r.\u0275fac=function(i){return new(i||r)(h(N),h(H))},r.\u0275cmp=S({type:r,selectors:[["app-request-info"]],standalone:!0,features:[A],decls:31,vars:7,consts:[[1,"bg-white","shadow","flex","justify-between","items-center","p-4","rounded-md","mb-6"],[1,"text-2xl"],[1,"flex","flex-wrap","gap-4"],[1,"bg-white","p-8","rounded-lg","shadow-lg","max-w-md"],[1,"text-xl","font-medium","mb-4"],[1,"space-y-2"],[1,"text-gray-500"],[1,"bg-gray-100","shadow","rounded-md","p-4"],[1,"font-semibold"],[1,"bg-white","p-8","rounded-lg","shadow-lg","max-w-md","flex-1"],["align","alternate",3,"value"],["pTemplate","marker"],["pTemplate","content"],["pTemplate","opposite"],[1,"custom-marker","shadow-2","bg-blue-600","rounded-full","text-white","w-5","h-5","align-middle"],[1,"p-text-secondary"]],template:function(i,o){if(i&1&&(n(0,"header",0)(1,"h2",1),s(2," Informaci\xF3n de la Solicitud "),l()(),n(3,"section",2)(4,"div",3)(5,"h2",4),s(6),l(),n(7,"div",5)(8,"div")(9,"span",6),s(10,"Descripci\xF3n:"),l(),n(11,"div",7),s(12),l()(),n(13,"div")(14,"span",6),s(15,"Fecha de la solicitud: "),l(),n(16,"span",8),s(17),F(18,"date"),l()(),n(19,"div")(20,"span",6),s(21,"Estado actual: "),l(),n(22,"span",8),s(23),l()()()(),n(24,"div",9)(25,"h2",4),s(26," Historial de estados "),l(),n(27,"p-timeline",10),u(28,Qe,1,0,"ng-template",11),u(29,Ge,3,3,"ng-template",12),u(30,Le,1,1,"ng-template",13),l()()()),i&2){let m,_,U,Q;p(6),R(" ",(m=o.selectedRequest())==null?null:m.title," "),p(6),v((_=o.selectedRequest())==null?null:_.description),p(5),v(I(18,5,(U=o.selectedRequest())==null?null:U.requestDate)),p(6),v(o.status),p(4),c("value",(Q=o.selectedRequest())==null?null:Q.statusChanges)}},dependencies:[C,O,Fe,Re,T],encapsulation:2});let t=r;return t})();function Je(t,r){t&1&&(n(0,"tr",21)(1,"th",22),s(2,"Titulo"),l(),n(3,"th",22),s(4,"Fecha"),l(),n(5,"th",22),s(6,"Acciones"),l()())}function Ye(t,r){if(t&1){let a=E();n(0,"tr")(1,"td",23),s(2),l(),n(3,"td",23),s(4),F(5,"date"),l(),n(6,"td",24)(7,"button",25),g("click",function(){let o=x(a).$implicit,m=f();return b(m.openSendDialogBox(o))}),s(8," Enviar "),d(9,"i",26),l(),n(10,"button",2),g("click",function(){let o=x(a).$implicit,m=f();return b(m.showRequestInfo(o))}),d(11,"i",27),l(),n(12,"button",28),g("click",function(){let o=x(a).$implicit,m=f();return b(m.openDeleteDialogBox(o))}),d(13,"i",29),l(),n(14,"button",30),d(15,"i",31),l()()()}if(t&2){let a=r.$implicit;p(2),v(a.title),p(2),v(I(5,2,a.requestDate))}}function Ke(t,r){if(t&1){let a=E();n(0,"button",32),g("click",function(){x(a);let i=f();return b(i.deleteRequest())}),d(1,"i",19),s(2," Aceptar "),l()}}function We(t,r){if(t&1){let a=E();n(0,"button",32),g("click",function(){x(a);let i=f();return b(i.sendRequest())}),d(1,"i",19),s(2," Enviar "),l()}}function Xe(t,r){if(t&1){let a=E();n(0,"button",32),g("click",function(){x(a);let i=f();return b(i.resetAll())}),d(1,"i",19),s(2," Aceptar "),l()}}var Ze=function(){return{"min-width":"50rem"}},et=function(){return[10,25,50]},B=function(){return{width:"50vw"}},tt=function(){return{width:"75vw"}},Ve=(()=>{let r=class r{constructor(e,i,o){this.requestService=e,this.router=i,this.fb=o,this.request=D([]),this.openDeleteDialog=!1,this.openSendDialog=!1,this.openAddDialogForm=!1,this.requestForm=this.fb.group({title:["",[k.required,k.minLength(3)]],description:["",[k.required,k.minLength(3)]]}),this.generalDialog=!1,this.generalDialogData=D({title:"",message:""})}ngOnInit(){this.requestService.getRequests().subscribe({next:e=>{this.request.set(e)}})}showRequestInfo(e){this.requestService.requestSelected=e,this.router.navigateByUrl("/backlog/requests/request-info")}deleteRequest(){this.requestService.deleteRequest().subscribe({next:()=>{this.request.update(e=>e.filter(i=>i.id!==this.requestService.requestSelectedValue?.id)),this.openDeleteDialog=!1,this.requestService.requestSelected=null},error:e=>{this.requestService.requestSelected=null}})}sendRequest(){this.requestService.sendRequest().subscribe({next:()=>{this.openSendDialog=!1,this.requestService.requestSelected=null,this.generalDialog=!0,this.generalDialogData.set({title:"Solicitud enviada!",message:"Se ha enviado la solicitud correctamente"})},error:e=>{this.requestService.requestSelected=null,this.generalDialog=!0,this.generalDialogData.set({title:"Ha ocurrido un error!",message:"Ha ocurrido un error inesperado. Si el problema persiste, contacte con el administrador"})}})}openDeleteDialogBox(e){this.openDeleteDialog=!0,this.requestService.requestSelected=e}openSendDialogBox(e){this.openSendDialog=!0,this.requestService.requestSelected=e}openAddDialogBox(){this.openAddDialogForm=!0}onCloseDialog(){this.requestService.requestSelected=null}submit(){this.requestForm.invalid||this.requestService.createRequest(this.requestForm.value).subscribe({next:e=>{this.request.update(i=>[...i,this.mappedToRequestDTO(e)]),this.openAddDialogForm=!1,this.requestService.requestSelected=null},error:e=>{console.log(e),this.requestService.requestSelected=null}})}resetAll(){this.requestForm.reset(),this.openDeleteDialog=!1,this.openSendDialog=!1,this.openAddDialogForm=!1,this.generalDialog=!1,this.generalDialogData.set({title:"",message:""}),this.requestService.requestSelected=null}mappedToRequestDTO(e){return{id:e.id,title:e.title,requestDate:e.requestDate}}};r.\u0275fac=function(i){return new(i||r)(h(N),h(ce),h(xe))},r.\u0275cmp=S({type:r,selectors:[["app-requests"]],standalone:!0,features:[A],decls:36,vars:39,consts:[[1,"bg-white","shadow","flex","justify-between","items-center","p-4","rounded-md","mb-6"],[1,"text-2xl"],[1,"bg-blue-500","flex","items-center","gap-2","text-white","font-bold","py-2","px-4","rounded","transition-colors","hover:bg-blue-700",3,"click"],[1,"pi","pi-plus-circle"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","showCurrentPageReport","tableStyle","rowsPerPageOptions"],["pTemplate","header"],["pTemplate","body"],["header","Eliminar petici\xF3n",3,"visible","modal","draggable","resizable","visibleChange","onHide"],[1,"m-0"],["pTemplate","footer"],["header","Enviar petici\xF3n",3,"visible","modal","draggable","resizable","visibleChange","onHide"],[3,"formGroup","ngSubmit"],[1,"grid","grid-cols-2","gap-4"],[1,"col-span-2"],["for","title"],["type","text","id","title","formControlName","title","pInputText","",1,"w-full","rounded-md","border-gray-300","shadow-md","border","p-2"],["for","description"],["id","description","formControlName","description","pInputTextarea","",1,"w-full","rounded-md","border-gray-300","shadow-md","border","resize-none","p-4"],["type","submit",1,"bg-green-500","ml-auto","flex","items-center","gap-2","text-white","font-bold","py-2","px-4","rounded","transition-colors","hover:bg-green-700","mt-4"],[1,"pi","pi-check"],[3,"header","visible","modal","draggable","resizable","visibleChange","onHide"],[1,"bg-cyan-600","text-white"],[1,"bg-cyan-600","text-white","text-center"],[1,"text-center"],[1,"flex","items-center","justify-center","gap-3"],[1,"bg-green-500","flex","items-center","gap-2","text-white","font-bold","py-2","px-4","rounded","transition-colors","hover:bg-green-700",3,"click"],[1,"pi","pi-send"],[1,"pi","pi-eye"],[1,"bg-red-500","flex","items-center","gap-2","text-white","font-bold","py-2","px-4","rounded","transition-colors","hover:bg-red-700",3,"click"],[1,"pi","pi-trash"],[1,"bg-green-500","flex","items-center","gap-2","text-white","font-bold","py-2","px-4","rounded","transition-colors","hover:bg-green-700"],[1,"pi","pi-pencil"],[1,"bg-green-500","ml-auto","flex","items-center","gap-2","text-white","font-bold","py-2","px-4","rounded","transition-colors","hover:bg-green-700",3,"click"]],template:function(i,o){i&1&&(n(0,"header",0)(1,"h2",1),s(2," Solicitudes"),l(),n(3,"button",2),g("click",function(){return o.openAddDialogBox()}),d(4,"i",3),s(5," Nuevo "),l()(),n(6,"section")(7,"p-table",4),u(8,Je,7,0,"ng-template",5),u(9,Ye,16,4,"ng-template",6),l(),n(10,"p-dialog",7),g("visibleChange",function(_){return o.openDeleteDialog=_})("onHide",function(){return o.onCloseDialog()}),n(11,"p",8),s(12," \xBFEstas seguro que desea eliminar la petici\xF3n? Esta acci\xF3n no se puede deshacer. "),l(),u(13,Ke,3,0,"ng-template",9),l(),n(14,"p-dialog",10),g("visibleChange",function(_){return o.openSendDialog=_})("onHide",function(){return o.onCloseDialog()}),n(15,"p",8),s(16," \xBFEstas seguro que desea enviar la petici\xF3n? Esta acci\xF3n no se puede deshacer. "),l(),u(17,We,3,0,"ng-template",9),l(),n(18,"p-dialog",10),g("visibleChange",function(_){return o.openAddDialogForm=_})("onHide",function(){return o.onCloseDialog()}),n(19,"form",11),g("ngSubmit",function(){return o.submit()}),n(20,"div",12)(21,"div",13)(22,"label",14),s(23,"Titulo"),l(),d(24,"input",15),l(),n(25,"div",13)(26,"label",16),s(27,"Descripci\xF3n"),l(),d(28,"textarea",17),l()(),n(29,"button",18),d(30,"i",19),s(31," Enviar "),l()()(),n(32,"p-dialog",20),g("visibleChange",function(_){return o.generalDialog=_})("onHide",function(){return o.resetAll()}),n(33,"p",8),s(34),l(),u(35,Xe,3,0,"ng-template",9),l()()),i&2&&(p(7),c("value",o.request())("paginator",!0)("rows",5)("showCurrentPageReport",!0)("tableStyle",q(33,Ze))("rowsPerPageOptions",q(34,et)),p(3),w(q(35,B)),c("visible",o.openDeleteDialog)("modal",!0)("draggable",!1)("resizable",!1),p(4),w(q(36,B)),c("visible",o.openSendDialog)("modal",!0)("draggable",!1)("resizable",!1),p(4),w(q(37,tt)),c("visible",o.openAddDialogForm)("modal",!0)("draggable",!1)("resizable",!1),p(1),c("formGroup",o.requestForm),p(13),w(q(38,B)),c("header",o.generalDialogData().title)("visible",o.generalDialog)("modal",!0)("draggable",!1)("resizable",!1),p(2),R(" ",o.generalDialogData().message," "))},dependencies:[C,O,ye,Te,T,Ee,De,be,_e,de,ge,fe,he,ve,Ce,Se],encapsulation:2});let t=r;return t})();var kt=[{path:"",component:Ve},{path:"request-info",component:ke},{path:"",redirectTo:"requests",pathMatch:"full"}];export{kt as REQUESTS_ROUTES};
