import{d as M,e as G,f as O,g as $}from"./chunk-GUQKOEOD.js";import"./chunk-54OSNODU.js";import{$ as R,Bb as w,F as a,G as y,Ja as F,K as q,Ka as z,M as m,Ma as U,N as t,O as i,P as f,T as E,U as d,V as v,ab as L,ba as o,ca as h,f as j,h as S,ha as P,ia as g,k as I,p as C,r as b,ra as T,s as _,sa as V,yb as x}from"./chunk-2TYDJMCA.js";import"./chunk-2XJVAMHT.js";var H=(()=>{let r=class r{constructor(e,n){this.http=e,this.user=n}getRequests(){return this.http.get(`${x.url}requests/allRequestPerDependence?idDependence=`+this.user.currentUserValue.dependence.id)}rejectRequest(e){return this.http.post(`${x.url}requests/reject?requestId=`+e,{})}VerifyRequest(e){return this.http.post(`${x.url}requests/verify?requestId=`+e,{})}};r.\u0275fac=function(n){return new(n||r)(S(U),S(w))},r.\u0275prov=j({token:r,factory:r.\u0275fac,providedIn:"root"});let l=r;return l})();function Q(l,r){l&1&&(t(0,"tr",14)(1,"th",15),o(2,"Titulo"),i(),t(3,"th",15),o(4,"Fecha"),i(),t(5,"th",15),o(6,"Acciones"),i()())}function K(l,r){if(l&1){let c=E();t(0,"tr")(1,"td",16),o(2),i(),t(3,"td",16),o(4),T(5,"date"),i(),t(6,"td",17)(7,"button",18),d("click",function(){let s=b(c).$implicit,p=v();return _(p.openViewDialogFunc(s))}),o(8," Ver solicitud completa "),f(9,"i",19),i()()()}if(l&2){let c=r.$implicit;a(2),h(c.title),a(2),h(V(5,2,c.requestDate))}}function W(l,r){if(l&1){let c=E();t(0,"div",20)(1,"button",21),d("click",function(){b(c);let n=v();return _(n.rejectRequest())}),f(2,"i",22),o(3," Rechazar solicitud "),i(),t(4,"button",23),d("click",function(){b(c);let n=v();return _(n.approveRequest())}),f(5,"i",24),o(6," Aprobar solicitud "),i()()}}var X=function(){return{"min-width":"50rem"}},Y=function(){return[10,25,50]},D=function(){return{width:"50vw"}},B=(()=>{let r=class r{constructor(e,n){this.requestService=e,this.currentUser=n,this.requestList=C([]),this.selectedRequest=C(null),this.openGoodResponse=!1,this.openErrResponse=!1,this.openViewDialog=!1}ngOnInit(){this.requestService.getRequests().subscribe({next:e=>this.requestList.set(e)})}get dependenceName(){return this.currentUser.currentUserValue.dependence.name}openViewDialogFunc(e){this.selectedRequest.set(e),this.openViewDialog=!0}approveRequest(){this.requestService.VerifyRequest(this.selectedRequest()?.id).subscribe({next:e=>{this.openGoodResponse=!0,this.openViewDialog=!1,this.requestList.update(n=>n.filter(s=>s.id!==this.selectedRequest()?.id)),this.selectedRequest.set(null)},error:e=>{this.openErrResponse=!0,this.openViewDialog=!1,this.selectedRequest.set(null)}})}rejectRequest(){this.requestService.rejectRequest(this.selectedRequest()?.id).subscribe({next:e=>{this.openGoodResponse=!0,this.openViewDialog=!1,this.requestList.update(n=>n.filter(s=>s.id!==this.selectedRequest()?.id)),this.selectedRequest.set(null)},error:e=>{this.openErrResponse=!0,this.openViewDialog=!1,this.selectedRequest.set(null)}})}};r.\u0275fac=function(n){return new(n||r)(y(H),y(w))},r.\u0275cmp=I({type:r,selectors:[["app-requests"]],standalone:!0,features:[P],decls:30,vars:35,consts:[[1,"bg-white","shadow","flex","justify-between","items-center","p-4","rounded-md","mb-6"],[1,"text-2xl"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","paginator","rows","showCurrentPageReport","tableStyle","rowsPerPageOptions"],["pTemplate","header"],["pTemplate","body"],["header","Informacion detallada de la solicitud",3,"visible","modal","draggable","resizable","visibleChange","onHide"],[1,"block","text-right"],[1,"flex","flex-col","mb-4"],[1,"inline-block","pb-1"],[1,"p-2","border","border-black","rounded-md"],[1,"border","border-black","rounded-md","p-3","resize-none",3,"value"],["pTemplate","footer"],["header","Solcitud aprobada",3,"visible","modal","draggable","resizable","visibleChange"],["header","Solcitud rechazada",3,"visible","modal","draggable","resizable","visibleChange"],[1,"bg-cyan-600","text-white"],[1,"bg-cyan-600","text-white","text-center"],[1,"text-center"],[1,"flex","items-center","justify-center","gap-3"],[1,"bg-green-500","flex","items-center","gap-2","text-white","font-bold","py-2","px-4","rounded","transition-colors","hover:bg-green-700",3,"click"],[1,"pi","pi-eye"],[1,"flex","justify-between","items-center","w-full"],[1,"bg-red-500","flex","items-center","gap-2","text-white","font-bold","py-2","px-4","rounded","transition-colors","hover:bg-red-700",3,"click"],[1,"pi","pi-trash"],[1,"bg-green-500","ml-auto","flex","items-center","gap-2","text-white","font-bold","py-2","px-4","rounded","transition-colors","hover:bg-green-700",3,"click"],[1,"pi","pi-check"]],template:function(n,s){if(n&1&&(t(0,"header",0)(1,"h2",1),o(2," Solicitudes pendientes"),i(),t(3,"span"),o(4),i()(),t(5,"section")(6,"p-table",2),q(7,Q,7,0,"ng-template",3),q(8,K,10,4,"ng-template",4),i(),t(9,"p-dialog",5),d("visibleChange",function(u){return s.openViewDialog=u})("onHide",function(){return s.selectedRequest.set(null)}),t(10,"div")(11,"span",6),o(12),T(13,"date"),i(),t(14,"div",7)(15,"span",8),o(16,"Titulo"),i(),t(17,"span",9),o(18),i()(),t(19,"div",7)(20,"span",8),o(21,"Descripcion "),i(),f(22,"textarea",10),i()(),q(23,W,7,0,"ng-template",11),i(),t(24,"p-dialog",12),d("visibleChange",function(u){return s.openGoodResponse=u}),t(25,"p"),o(26,"La solicitud ha sido aprobada correctamente!"),i()(),t(27,"p-dialog",13),d("visibleChange",function(u){return s.openErrResponse=u}),t(28,"p"),o(29,"La solicitud ha sido rechazada correctamente. Se le ha informado al usuario!"),i()()()),n&2){let p,u,k;a(4),h(s.dependenceName),a(2),m("value",s.requestList())("paginator",!0)("rows",5)("showCurrentPageReport",!0)("tableStyle",g(30,X))("rowsPerPageOptions",g(31,Y)),a(3),R(g(32,D)),m("visible",s.openViewDialog)("modal",!0)("draggable",!1)("resizable",!1),a(3),h(V(13,28,(p=s.selectedRequest())==null?null:p.requestDate)),a(6),h((u=s.selectedRequest())==null?null:u.title),a(4),m("value",(k=s.selectedRequest())==null?null:k.description),a(2),R(g(33,D)),m("visible",s.openGoodResponse)("modal",!0)("draggable",!1)("resizable",!1),a(3),R(g(34,D)),m("visible",s.openErrResponse)("modal",!0)("draggable",!1)("resizable",!1)}},dependencies:[z,F,G,M,L,$,O],encapsulation:2});let l=r;return l})();var he=[{path:"",component:B},{path:"**",redirectTo:"/backlog/boss",pathMatch:"full"}];export{he as REQUESTS_BOSS_ROUTES};
